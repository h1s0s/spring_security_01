1장 시큐리티 빌더(SecurityBuilder) / 시큐리티컨피규어(SecurityConfigurer)

#개념#########

스프링 시큐리티는 초기화 때 인증/인가와 관련된 여러가지 작업들을 수행 함.
이것들을 종합적으로 처리하는 클래스가 이 두개임.
스프링 시큐리티는 모든 인증, 인가를 필터에서 처리함.
한마디로 스프링 시큐리티는 필터 기반 보안 프레임워크이다라고 이해해도 무방함.

1. 시큐리티 빌더(SecurityBuilder) (HttpSecurity, WebSecurity, AuthenticationManagerbuilder)
- 빌더 클래스로서 웹 보안을 구성하는 빈 객체와 설정 클래스들을 생성하는 역할. 대표적으로 WebSecurity, HttpSecurity★가 있다.
- 시큐리티컨피규어를 참조하고 있음. 참조한다는 것은 시큐리티컨피규어를 사용하여 빈 객체와 설정클래스를 생성한다는 말.

2. 시큐리티컨피규어(SecurityConfigurer, 설정클래스)
- Http 요청과 관련된 보안처리를 담당하는 필터를 생성(중요)
  (※ 스프링 시큐리티는 모든 인증, 인가를 필터에서 처리함)
- 여러 초기화 설정에 관여한다
- 인증 및 인가 초기화 작업을 진행함.
- 구현체로 SecurityContextConfigurer, HttpBasicConfigurer, FormLoginConfigurer, CsrfConfigurer, ExceptionHandlingConfigurer, AnonymousConfigurer가 있음.
- 이 구현체들이 가지고있는 여러가지 기능들을 진행시키면서 초기 작업들을 이끌어가는 것.


#실행 구조##########
1. AutoConfiguration(자동설정) 클래스 -> build() : 시큐리티 빌더 클래스 생성
: 자동 설정에 의해 SecurityBuilder 클래스를 만듬.
: HttpSecurity 같은 클래스도 이때 자동설정에 의해서 빈 객체로 생성됨.

2.SecurityBuilder 클래스 -> SecurityConfigurer를 기반으로 설정 클래스들을 생성하며
init, configure 메소드를 사용하여 초기화 작업을 진행합니다(필터들을 생성합니다).
※ Configurer(설정 클래스)마다 각각 필터가 있음 1:1 매칭

2장 웹 시큐리티(WebSecurity) / Http시큐리티 (HttpSecurity)

1. HttpSecurity
- HttpSecurityConfiguration에서 생성한 클래스
- 보안에 필요한 각 설정 클래스와 필터들을 생성하고 최종적으로 "SecurityFilterChain" 빈 생성
- SecurityFilterChain이 빈 안에 여러개의 인증/인가를 처리하는 Filter들을 생성함. 아주 중요하다고 볼 수 있겠음.

2. WebSecurity
- WebSecurityConfiguration에서 생성한 클래스
- SecurityFilterChain 빈을 SecurityBuilder에 저장함. 이유는, 이 것이 build()를 실행하면
FilterChainProxy 생성자에게 전달하기 위함

3장 DelegatingFilterProxy/FilterChainProxy

1.Filter
- 서블릿 필터는 웹 애플리케이션에서 클라이언트의 요청(ServletReqeust)과 서버의 응답(ServletResponse)을 가공하거나 검사하는데 사용되는 구성 요소
- 클라이언트의 요청이 서블릿에 도달하기 전이나 응답을 클라이언트에게 보내기 전에 특정 작업을 수행할 수 있다.
- 서블릿 컨테이너(WAS, 흔히 tomcat)에서 실행되고 종료된다.
- filter 인터페이스를 보면, init, doFilter, destroy가 있음. init은 생성시 필요한 작업, destroy는 제거될 때 필요한 작업
doFilter는 요청 전후에 대한 작업

2.DelegatingFilterProxy
- 스프링의 의존성 주입 및 빈 관리 기능과 연동되도록 설계된 필터
- 스프링에서 사용되는 특별한 서블릿 필터, 서블릿 컨테이너와 스프링 애플리케이션 컨텍스트 간의 연결고리 역할을 하는 필터
- "springSecurityFilterChain" 이름으로 생성된 빈을 ApplicationContext에서 찾아 요청을 위임한다
- 실제 보안 처리를 수행하지 않는다
- Filter는 원래 SevletContainer에서 생성되고 지워짐, Spring Container이랑은 상관 없움.
필터에서는 스프링 기능을 사용할 수 없음, DI/AOP기능 사용 불가
필터에서 DI나 AOP같은 스프링의 기능들을 사용할 수 있게끔 도와주는 클래스임.

3.FilterChainProxy
- SpringSecurityFilterChain의 이름으로 생성되는 필터 빈으로서, DelegatingFilterProxy로부터 요청을 위임받고 보안처리 역할을 한다.